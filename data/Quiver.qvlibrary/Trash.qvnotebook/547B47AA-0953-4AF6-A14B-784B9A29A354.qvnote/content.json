{
  "title": "贝蓓乐数据用户ID回溯",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; white-space: normal;\"><div>删除临时表：&nbsp; &nbsp; drop table if exists dm_call_beibeile_d_niu_temp2</div><div>创建临时表：&nbsp; &nbsp; create table dm_call_beibeile_d_niu_temp2&nbsp; ( program_id string,</div><div>day_id date,</div><div>data_time timestamp,</div><div>name string,</div><div>family_name string,</div><div>mobile string,</div><div>phone_num string,</div><div>sex string,</div><div>city_id int,</div><div>area_id int,</div><div>address string,</div><div>postcode int,</div><div>child_flag int,</div><div>child_name string,</div><div>child_sex string,</div><div>child_birthday date,</div><div>user_id_niu string,</div><div>user_id_che string,</div><div>pt_date string ) row format delimited fields terminated by &apos;\\t&apos; lines terminated by &apos;\\n&apos;</div><div><br/></div><div>ALTER TABLE dm.dm_call_beibeile_d_niu_temp2 SET SERDEPROPERTIES(&apos;serialization.null.format&apos; = &apos;&apos;);</div><div><br/></div><div><br/></div><div>drop table if exists dm_call_beibeile_d_niu_result</div><div>create table dm_call_beibeile_d_niu_result like dm_call_beibeile_d_niu</div><div>set hive.exec.dynamic.partition=true;</div><div>set hive.exec.dynamic.partition.mode=nonstrict;</div><div>INSERT OVERWRITE table dm_call_beibeile_d_niu_result PARTITION (pt_date ) select program_id, day_id, data_time, name, family_name, mobile, phone_num, sex, city_id, area_id, address, postcode, child_flag, child_name, child_sex, child_birthday, user_id_niu, user_id_che, regexp_replace(day_id , &apos;-&apos;, &apos;&apos;)from dm_call_beibeile_d_niu_temp2 where day_id is not null ;</div><div><br/></div><div><br/></div><div>INSERT OVERWRITE table dm_call_beibeile_d_niu_result PARTITION (pt_date )</div><div>select program_id, day_id, data_time, name, family_name, mobile,</div><div>phone_num, sex, city_id, area_id, address, postcode,</div><div>child_flag, child_name, child_sex, child_birthday,</div><div>user_id_niu, user_id_che, regexp_replace(day_id , &apos;-&apos;, &apos;&apos;)from dm_call_beibeile_d_niu_temp where day_id is not null limit 2000</div><div><br/></div><div><br/></div></div>"
    }
  ]
}