{
  "title": "5.3 修改",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; white-space: normal;\"><div><b>0 创建结果表</b></div><div>create table <b>dm_call_beibeile_d_niu_result</b> like <b>dm_call_beibeile_d_niu;</b></div><div><b><br/></b></div><div><b>1 从hdfs导入临时表</b></div><div>set hive.exec.dynamic.partition=true;</div><div>set hive.exec.dynamic.partition.mode=nostrick;</div><div align=\"left\"><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt\">load data inpath &apos;</span></font><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt; background:#e8f2fe\">hdfs://namenode.Hadoop:9000/niu/test2=9/ProcesszResult0/dm_call_beibeile_d_niu/null/-r-00003</span></font><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt\">&apos; into table dm_call_beibeile_d_niu_temp</span></font><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt\">;</span></font></div><div align=\"left\"><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><br/></div><div align=\"left\"><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div align=\"left\"><b><span style=\"font-size: 10.5pt;\"><span style=\"color: rgb(51, 51, 51);\">2 从临时表导入结果表</span></span></b></div><div align=\"left\"><font color=\"#333333\" style=\"word-wrap: break-word;\"><font style=\"word-wrap: break-word;\"><font style=\"word-wrap: break-word; font-size: 10.5pt;\">set hive.exec.dynamic.partition=true;</font></font></font></div><div align=\"left\"><font color=\"#333333\" style=\"word-wrap: break-word;\"><font style=\"word-wrap: break-word;\"><font style=\"word-wrap: break-word; font-size: 10.5pt;\">set hive.exec.dynamic.partition.mode=nonstrict;</font></font></font></div><div><span style=\"color: rgb(42, 0, 255);\">INSERT OVERWRITE table</span> <b><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt\">dm_call_beibeile_d_niu_result</span></font></b> <span style=\"color: rgb(42, 0, 255);\">PARTITION (</span><font face=\"Consolas\" size=\"2\"><span style=\"font-size:10pt\">pt_date</span></font> <span style=\"color: rgb(42, 0, 255);\">) select&nbsp;</span></div><div align=\"left\"><font face=\"Consolas\" size=\"2\"><span style=\"font-size:10pt\">program_id, day_id, data_time, name, family_name, mobile, phone_num, sex, city_id, area_id, address, postcode, child_flag, child_name, child_sex, child_birthday, user_id_niu, user_id_che,</span></font> regexp_replace(<font face=\"Consolas\" size=\"2\"><span style=\"font-size:10pt\">day_id</span></font> , &apos;-&apos;, &apos;&apos;)&nbsp;</div><div><span style=\"color: rgb(42, 0, 255);\">from</span> <b style=\"color: rgb(0, 0, 0); font-family: 微软雅黑; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: medium;\"><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size: 10pt;\">dm_call_beibeile_d_niu_</span></font></b><b><font color=\"#2A00FF\" size=\"2\"><span style=\"font-size:10pt\">temp</span></font></b> <span style=\"color: rgb(42, 0, 255);\">;</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">1 生成带用户ID的数据集，分项目存放</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">2 生成临时表结构（如果存在就先删除）</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">3 将各个项目的数据存入临时表</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">4 生成结果表结构</span><span style=\"color: rgb(42, 0, 255);\">（如果存在就先删除）</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">5 将临时表的数据动态插入到结果表</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\">6 删除原始表，删除临时表，</span><span style=\"color: rgb(42, 0, 255);\">重命名结果表</span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div><div><span style=\"color: rgb(42, 0, 255);\"><br/></span></div></div>"
    }
  ]
}