{
  "title": "return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; white-space: normal;\"><div><h1 style=\"box-sizing: border-box; font-size: 18px; margin: 0px; font-family: SourceSans; color: white; font-weight: 600; padding: 0px; float: left;\"><a href=\"https://discuss.zendesk.com/\" style=\"box-sizing: border-box; background-color: transparent; color: white; text-decoration: none; font-family: SourceSans;\"><img src='quiver-image-url/B3C25D8B7FBA28A511FB8D24C4595D85' style='box-sizing: border-box; border: 0px; max-width: 100%; vertical-align: middle; height: 64px; float: none;'>&nbsp;<span style=\"box-sizing: border-box; font-weight: 400; padding-left: 12px; -webkit-font-smoothing: antialiased;\">Pivotal</span>&nbsp;Knowledge Base</a></h1><div style=\"box-sizing: border-box; float: right; padding: 5px 15px 0px; font-weight: 500;\"><div style=\"box-sizing: border-box; clear: none; display: inline-block; padding-top: 18px;\"><div style=\"box-sizing: border-box; font-size: 16px; float: right;\"><span style=\"box-sizing: border-box; color: rgb(255, 255, 255); -webkit-font-smoothing: antialiased; font-size: 16px;\">+1 877.477.2269</span>&nbsp;<a href=\"http://network.pivotal.io/\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; -webkit-font-smoothing: antialiased; font-size: 16px;\" target=\"_blank\">Downloads</a>&nbsp;<a href=\"http://docs.pivotal.io/\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; -webkit-font-smoothing: antialiased; font-size: 16px;\" target=\"_blank\">Documentation</a>&nbsp;<a href=\"https://support.pivotal.io/\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; -webkit-font-smoothing: antialiased; font-size: 16px;\" target=\"_blank\">My Tickets</a></div></div></div><a name=\"search-anchor\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(27, 120, 179); text-decoration: none; font-family: SourceSans; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"/><div style=\"box-sizing: border-box; font-size: 16px; vertical-align: middle; font-weight: normal;\"><h2 style=\"box-sizing: border-box; font-family: SourceSans; color: rgb(85, 85, 85); font-weight: 300; padding-bottom: 10px;\">Find the answer to your question</h2></div><ol style=\"box-sizing: border-box; list-style: none; margin: 0px; padding: 0px; display: inline-block; -webkit-font-smoothing: antialiased;\"><li style=\"box-sizing: border-box; display: inline-block; white-space: nowrap; margin-top: 20px; margin-bottom: 10px; font-size: 18px;\" title=\"All Help &amp;amp; Support\"><a href=\"https://discuss.zendesk.com/\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(27, 120, 179); text-decoration: none; font-family: SourceSans;\">All Help &amp; Support</a>&nbsp;</li><li style=\"box-sizing: border-box; display: inline-block; white-space: nowrap; margin-top: 20px; margin-bottom: 10px; font-size: 18px;\" title=\"Pivotal HD Knowledge Base\">&nbsp;<a href=\"https://discuss.zendesk.com/hc/en-us/categories/200072578-Pivotal-HD-Knowledge-Base\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(27, 120, 179); text-decoration: none; font-family: SourceSans;\">Pivotal HD Knowledge Base</a>&nbsp;</li><li style=\"box-sizing: border-box; display: inline-block; white-space: nowrap; margin-top: 20px; margin-bottom: 10px; font-size: 18px;\" title=\"Solution References\">&nbsp;<a href=\"https://discuss.zendesk.com/hc/en-us/sections/200238566-Solution-References\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(27, 120, 179); text-decoration: none; font-family: SourceSans;\">Solution References</a></li></ol><h1 style=\"box-sizing: border-box; font-size: 30px; margin: 0px; font-family: SourceSans; color: rgb(85, 85, 85); font-weight: 300;\">Hive Query from Tableau failed with error Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask</h1><p style=\"box-sizing: border-box; color: rgb(85, 85, 85); font-size: 13px;\"><a href=\"https://discuss.zendesk.com/hc/en-us/profiles/476025696-Bhuvnesh\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(27, 120, 179); text-decoration: none; font-family: SourceSans;\">Bhuvnesh</a></p><div style=\"box-sizing: border-box; background: white; border-radius: 3px; padding: 10px 20px; width: 1100px;\"><div style=\"box-sizing: border-box; font-size: 16px; word-wrap: break-word;\"><p style=\"box-sizing: border-box;\"><span style=\"box-sizing: border-box; font-size: large;\"><strong style=\"box-sizing: border-box; font-weight: 700;\">Problem:</strong></span></p><p style=\"box-sizing: border-box;\">Query from Tableau against hive external table pulling data from hbase fails, however regular tables with hive can be queried successfully from Tableau. All queries executed directly from a hive&nbsp;client on the cluster node works irrespective if its a external table or regular table.</p><p style=\"box-sizing: border-box;\">On Tableau, you can see an error similar to the below which is a generic error.</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask</span> \n</pre><p style=\"box-sizing: border-box;\">Further review of&nbsp;/var/log/gphd/hive/hive.log can indicate class not found exceptions similar to the below. The below lists all the exception which were encountered while setting up Tableau connection with hive external tables based on hbase.</p><p style=\"box-sizing: border-box;\">Exception 1:</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">Error: java.lang.<span style=\"box-sizing: border-box; color: rgb(255, 51, 51);\">ClassNotFoundException: org.apache.hadoop.hbase.mapreduce.TableSplit</span>\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:372)\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:361)\n</span></pre><p style=\"box-sizing: border-box;\">Exception 2:</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">Error: java.lang.<span style=\"box-sizing: border-box; color: rgb(255, 51, 51);\">ClassNotFoundException: org.apache.hadoop.hbase.client.HTable</span>\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n        at java.security.AccessController.doPrivileged(Native Method)\n</span></pre><p style=\"box-sizing: border-box;\">Exception 3:</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">Error: java.io.IOException: <span style=\"box-sizing: border-box; color: rgb(255, 51, 51);\">java.io.IOException: java.lang.reflect.InvocationTargetException</span>\n        at org.apache.hadoop.hive.io.HiveIOExceptionHandlerChain.handleRecordReaderCreationException(HiveIOExceptionHandlerChain.java:97)\n\n...\n...\nCaused by: java.lang.<span style=\"box-sizing: border-box; color: rgb(255, 51, 51);\">ClassNotFoundException: org.cloudera.htrace.Trace</span>\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n</span></pre><p style=\"box-sizing: border-box;\">Exception 4:</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">Error: java.lang.<span style=\"box-sizing: border-box; color: rgb(255, 51, 51);\">ClassNotFoundException: org.apache.hadoop.hbase.protobuf.generated.MasterProtos$MasterService$BlockingInterface</span>\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)</span> \n</pre><p style=\"box-sizing: border-box;\"><span style=\"box-sizing: border-box; font-size: large;\"><strong style=\"box-sizing: border-box; font-weight: 700;\">Cause:</strong></span></p><p style=\"box-sizing: border-box;\">Integration of hive with hbase requires all the required hbase classes to be available in hive classpath. Auxiliary jar path setup in&nbsp;/etc/gphd/hive/conf/hive-env.sh is not visible to Tableau initiated connections and even if it&apos;s set you will see the above errors. You must set the hive.aux.jars.path parameter in hive-site.xml for the required jars to be located while querying from Tableau.</p><p style=\"box-sizing: border-box;\">Other queries on regular hive tables from Tableau will work since the required jars have already been sourced.</p><p style=\"box-sizing: border-box;\">In case, there are other similar class not found exception you need to add the respective classes to hive.aux.jars.path in hive-site.xml&nbsp;</p><p style=\"box-sizing: border-box;\"><span style=\"box-sizing: border-box; font-size: large;\"><strong style=\"box-sizing: border-box; font-weight: 700;\">Fix:</strong></span></p><p style=\"box-sizing: border-box;\">Add the below parameters to /etc/gphd/hive/conf/hive-site.xml on hive-server. hive-server restart is not required.</p><pre style=\"box-sizing: border-box; overflow: auto; font-family: monospace, monospace; font-size: 14px; background: rgba(0, 0, 0, 0.0196078); border: 1px solid rgba(0, 0, 0, 0.0666667); border-radius: 3px; padding: 10px 15px; white-space: pre;\"><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\">&lt;property&gt;</span><br style=\"box-sizing: border-box;\"/><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\"> &lt;name&gt;hive.aux.jars.path&lt;/name&gt;</span><br style=\"box-sizing: border-box;\"/><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\"> &lt;value&gt;file:///usr/lib/gphd/hbase/lib/<span style=\"box-sizing: border-box; color: rgb(51, 51, 255);\">hbase-server.jar</span>,file:///usr/lib/gphd/hbase/lib/<span style=\"box-sizing: border-box; color: rgb(51, 51, 255);\">hbase-client.jar</span>,file:///usr/lib/gphd/hbase/lib/<span style=\"box-sizing: border-box; color: rgb(51, 51, 255);\">hbase-protocol.jar</span>,file:///usr/lib/gphd/hbase/lib/<span style=\"box-sizing: border-box; color: rgb(51, 51, 255);\">htrace-core-2.01.jar</span>&lt;/value&gt;</span><br style=\"box-sizing: border-box;\"/><span style=\"box-sizing: border-box; font-size: 16px !important; font-weight: 200;\"> &lt;/property&gt;</span></pre><p style=\"box-sizing: border-box;\">The below provides the mapping of the classes and their respective jars</p><table border=\"|\" style=\"box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; table-layout: fixed; height: 80px;width:544px;\" width=\"544\"><tbody><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; padding: 0px;width:50%;\"><strong style=\"box-sizing: border-box; font-weight: 700;\">Class Name</strong></td><td style=\"box-sizing: border-box; padding: 0px;width:50%;\"><strong style=\"box-sizing: border-box; font-weight: 700;\">Jar Name</strong></td></tr><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; padding: 0px;\">TableSplit</td><td style=\"box-sizing: border-box; padding: 0px;\">hbase-server.jar</td></tr><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; padding: 0px;\">HTable</td><td style=\"box-sizing: border-box; padding: 0px;\">hbase-client.jar</td></tr><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; padding: 0px;\">MasterProtos</td><td style=\"box-sizing: border-box; padding: 0px;\">hbase-protocol.jar</td></tr><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; padding: 0px;\">org.cloudera.htrace.Trace</td><td style=\"box-sizing: border-box; padding: 0px;\">htrace-core-2.01.jar</td></tr></tbody></table></div><div style=\"box-sizing: border-box; position: relative; float: left;\"><span style=\"box-sizing: border-box;\">Was this article helpful?</span>&nbsp;\n<div style=\"box-sizing: border-box; display: inline-block; margin-left: 20px;\"><a href=\"https://discuss.zendesk.com/hc/en-us/signin?return_to=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" rel=\"nofollow\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: entypo; border-radius: 50%; cursor: pointer; display: inline-block; font-size: 14px; height: 30px; padding: 0px 10px; position: relative; vertical-align: middle; white-space: nowrap; box-shadow: none; border: 0px;\" title=\"Yes\"/>&nbsp;<a href=\"https://discuss.zendesk.com/hc/en-us/signin?return_to=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" rel=\"nofollow\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: entypo; border-radius: 50%; cursor: pointer; display: inline-block; font-size: 14px; height: 30px; padding: 0px 10px; position: relative; vertical-align: middle; white-space: nowrap; box-shadow: none; border: 0px;\" title=\"No\"/></div>\n&nbsp;<small style=\"box-sizing: border-box; font-size: 12.8px; color: rgb(166, 166, 166); left: 20px; position: relative; white-space: nowrap; display: inline-block;\"><span style=\"box-sizing: border-box;\">0 out of 0 found this helpful</span></small></div><ul style=\"box-sizing: border-box; list-style: none; margin: 0px; padding: 0px; float: right;\"><li style=\"box-sizing: border-box; display: inline-block;\"><a href=\"http://www.facebook.com/share.php?title=Hive+Query+from+Tableau+failed+with+error+Execution+Error%2C+return+code+2+from+org.apache.hadoop.hive.ql.exec.mr.MapRedTask&amp;amp;u=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; box-shadow: none; border: 0px; border-radius: 50%; display: inline-block; height: 30px; overflow: hidden; vertical-align: middle; width: 30px;\">Facebook</a></li><li>&nbsp;</li><li style=\"box-sizing: border-box; display: inline-block;\"><a href=\"https://twitter.com/share?lang=en&amp;amp;text=Hive+Query+from+Tableau+failed+with+error+Execution+Error%2C+return+code+2+from+org.apache.hadoop.hive.ql.exec.mr.MapR...&amp;amp;url=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; box-shadow: none; border: 0px; border-radius: 50%; display: inline-block; height: 30px; overflow: hidden; vertical-align: middle; width: 30px;\">Twitter</a></li><li>&nbsp;</li><li style=\"box-sizing: border-box; display: inline-block;\"><a href=\"http://www.linkedin.com/shareArticle?mini=true&amp;amp;source=Pivotal&amp;amp;title=Hive+Query+from+Tableau+failed+with+error+Execution+Error%2C+return+code+2+from+org.apache.hadoop.hive.ql.exec.mr.MapRedTask&amp;amp;url=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; box-shadow: none; border: 0px; border-radius: 50%; display: inline-block; height: 30px; overflow: hidden; vertical-align: middle; width: 30px;\">LinkedIn</a></li><li>&nbsp;</li><li style=\"box-sizing: border-box; display: inline-block;\"><a href=\"https://plus.google.com/share?hl=en-us&amp;amp;url=https%3A%2F%2Fdiscuss.zendesk.com%2Fhc%2Fen-us%2Farticles%2F203025186-Hive-Query-from-Tableau-failed-with-error-Execution-Error-return-code-2-from-org-apache-hadoop-hive-ql-exec-mr-MapRedTask\" style=\"box-sizing: border-box; background: rgb(204, 204, 204); color: rgb(255, 255, 255); text-decoration: none; font-family: SourceSans; box-shadow: none; border: 0px; border-radius: 50%; display: inline-block; height: 30px; overflow: hidden; vertical-align: middle; width: 30px;\">Google+</a></li></ul></div><div style=\"box-sizing: border-box; background: white; border-radius: 3px; padding: 10px 20px; width: 1100px;\"><h2 style=\"box-sizing: border-box; font-family: SourceSans; color: rgb(85, 85, 85); font-weight: 300; font-size: 14px;\">Comments</h2></div><div style=\"box-sizing: border-box; width: 1347px; text-align: center; margin: 0px; float: left;\"><p style=\"box-sizing: border-box; color: white; font-size: 14px; font-weight: 200;\">©&nbsp;2016&nbsp;<a href=\"http://pivotal.io/\" style=\"box-sizing: border-box; background-color: transparent; color: white; text-decoration: none; font-family: SourceSans; font-weight: 400;\">Pivotal Software</a>, Inc. All Rights Reserved.<br style=\"box-sizing: border-box;\"/></p></div><div style=\"box-sizing: border-box; clear: both; text-align: right; padding: 10px 15px; height: 38px; color: rgb(68, 68, 68); font-family: SourceSans; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(29, 29, 29);\"><div>&nbsp;<a href=\"https://www.zendesk.com/help-center/?utm_source=helpcenter&amp;amp;utm_medium=poweredbyzendesk&amp;amp;utm_campaign=text&amp;amp;utm_content=Pivotal\" style=\"box-sizing: border-box; background-color: transparent; color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-size: 13px;\" target=\"_blank\">Powered by Zendesk</a></div></div></div></div>"
    }
  ]
}